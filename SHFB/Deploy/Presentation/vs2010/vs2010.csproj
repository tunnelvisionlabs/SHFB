<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{42A70C22-A7FD-4053-B717-1C6F5E85FA1A}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>VS2010</RootNamespace>
    <AssemblyName>VS2010</AssemblyName>
    <TargetFrameworkVersion>v4.0</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="System" />
    <Reference Include="System.Core" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Xml" />
  </ItemGroup>
  <ItemGroup>
    <Content Include="Branding\branding-cs-CZ.xslt" />
    <Content Include="Branding\branding-de-DE.xslt" />
    <Content Include="Branding\branding-en-US.xslt" />
    <Content Include="Branding\branding-es-ES.xslt" />
    <Content Include="Branding\branding-fr-FR.xslt" />
    <Content Include="Branding\branding-it-IT.xslt" />
    <Content Include="Branding\branding-ja-JP.xslt" />
    <Content Include="Branding\branding-ko-KR.xslt" />
    <Content Include="Branding\branding-pl-PL.xslt" />
    <Content Include="Branding\branding-pt-BR.xslt" />
    <Content Include="Branding\branding-ru-RU.xslt" />
    <Content Include="Branding\branding-tr-TR.xslt" />
    <Content Include="Branding\branding-zh-CN.xslt" />
    <Content Include="Branding\branding-zh-TW.xslt" />
    <Content Include="Branding\branding.manifest" />
    <Content Include="Branding\branding.xml" />
    <Content Include="Branding\branding.xslt" />
    <Content Include="Branding\dev10.manifest" />
    <Content Include="Branding\favicon.ico" />
    <Content Include="Branding\ps-body.xslt" />
    <Content Include="Branding\ps-codesnippet.xslt" />
    <Content Include="Branding\ps-collapsibleArea.xslt" />
    <Content Include="Branding\ps-foot.xslt" />
    <Content Include="Branding\ps-head.xslt" />
    <Content Include="Branding\ps-instrumentedLink.xslt" />
    <Content Include="Branding\ps-languageSpecificText.xslt" />
    <Content Include="configuration\conceptual.config" />
    <Content Include="configuration\sandcastle-mshc.config" />
    <Content Include="configuration\sandcastle.config" />
    <Content Include="Content\conceptual_content.xml" />
    <Content Include="Content\de-DE\conceptual_content.xml" />
    <Content Include="Content\de-DE\feedBack_content.xml" />
    <Content Include="Content\de-DE\reference_content.xml" />
    <Content Include="Content\de-DE\shared_content.xml" />
    <Content Include="Content\de-DE\shared_content_mshc.xml" />
    <Content Include="Content\de-DE\syntax_content.xml" />
    <Content Include="Content\de-DE\web_content.xml" />
    <Content Include="Content\feedBack_content.xml" />
    <Content Include="Content\reference_content.xml" />
    <Content Include="Content\ru-RU\conceptual_content.xml" />
    <Content Include="Content\ru-RU\feedBack_content.xml" />
    <Content Include="Content\ru-RU\reference_content.xml" />
    <Content Include="Content\ru-RU\shared_content.xml" />
    <Content Include="Content\ru-RU\shared_content_mshc.xml" />
    <Content Include="Content\ru-RU\syntax_content.xml" />
    <Content Include="Content\ru-RU\web_content.xml" />
    <Content Include="Content\shared_content.xml" />
    <Content Include="Content\shared_content_mshc.xml" />
    <Content Include="Content\syntax_content.xml" />
    <Content Include="Content\web_content.xml" />
    <Content Include="Data\bibliography.xml" />
    <Content Include="icons\1_404_bullet.gif" />
    <Content Include="icons\2_404_bullet.gif" />
    <Content Include="icons\alert_caution.gif" />
    <Content Include="icons\alert_note.gif" />
    <Content Include="icons\alert_security.gif" />
    <Content Include="icons\CFW.gif" />
    <Content Include="icons\close.gif" />
    <Content Include="icons\favicon.ico" />
    <Content Include="icons\footer_slice.gif" />
    <Content Include="icons\info_icon.gif" />
    <Content Include="icons\note.gif" />
    <Content Include="icons\online_icon.gif" />
    <Content Include="icons\open.gif" />
    <Content Include="icons\pencil.GIF" />
    <Content Include="icons\privclass.gif" />
    <Content Include="icons\privdelegate.gif" />
    <Content Include="icons\privenumeration.gif" />
    <Content Include="icons\privevent.gif" />
    <Content Include="icons\privextension.gif" />
    <Content Include="icons\privfield.gif" />
    <Content Include="icons\privinterface.gif" />
    <Content Include="icons\privmethod.gif" />
    <Content Include="icons\privproperty.gif" />
    <Content Include="icons\privstructure.gif" />
    <Content Include="icons\protclass.gif" />
    <Content Include="icons\protdelegate.gif" />
    <Content Include="icons\protenumeration.gif" />
    <Content Include="icons\protevent.gif" />
    <Content Include="icons\protextension.gif" />
    <Content Include="icons\protfield.gif" />
    <Content Include="icons\protinterface.gif" />
    <Content Include="icons\protmethod.gif" />
    <Content Include="icons\protoperator.gif" />
    <Content Include="icons\protproperty.gif" />
    <Content Include="icons\protstructure.gif" />
    <Content Include="icons\pubclass.gif" />
    <Content Include="icons\pubdelegate.gif" />
    <Content Include="icons\pubenumeration.gif" />
    <Content Include="icons\pubevent.gif" />
    <Content Include="icons\pubextension.gif" />
    <Content Include="icons\pubfield.gif" />
    <Content Include="icons\pubinterface.gif" />
    <Content Include="icons\pubmethod.gif" />
    <Content Include="icons\puboperator.gif" />
    <Content Include="icons\pubproperty.gif" />
    <Content Include="icons\pubstructure.gif" />
    <Content Include="icons\search.gif" />
    <Content Include="icons\search_bk.gif" />
    <Content Include="icons\security.gif" />
    <Content Include="icons\slMobile.gif" />
    <Content Include="icons\static.gif" />
    <Content Include="icons\tabLeftBG.gif" />
    <Content Include="icons\tabRightBG.gif" />
    <Content Include="icons\ui_om_collapse.gif" />
    <Content Include="icons\ui_om_expand.gif" />
    <Content Include="icons\xna.gif" />
    <Content Include="scripts\branding.js" />
    <Content Include="styles\branding-cs-CZ.css" />
    <Content Include="styles\branding-de-DE.css" />
    <Content Include="styles\branding-en-US.css" />
    <Content Include="styles\branding-es-ES.css" />
    <Content Include="styles\branding-fr-FR.css" />
    <Content Include="styles\branding-it-IT.css" />
    <Content Include="styles\branding-ja-JP.css" />
    <Content Include="styles\branding-ko-KR.css" />
    <Content Include="styles\branding-pl-PL.css" />
    <Content Include="styles\branding-pt-BR.css" />
    <Content Include="styles\branding-ru-RU.css" />
    <Content Include="styles\branding-tr-TR.css" />
    <Content Include="styles\branding-zh-CN.css" />
    <Content Include="styles\branding-zh-TW.css" />
    <Content Include="styles\branding.css" />
    <Content Include="transforms\codeTemplates.xsl" />
    <Content Include="transforms\conceptualMetadataHelp20.xsl" />
    <Content Include="transforms\conceptualMetadataHelp30.xsl" />
    <Content Include="transforms\conceptualTopicTypes.xsl" />
    <Content Include="transforms\globalTemplates.xsl" />
    <Content Include="transforms\main_conceptual.xsl" />
    <Content Include="transforms\main_sandcastle.xsl" />
    <Content Include="transforms\metadataHelp20.xsl" />
    <Content Include="transforms\metadataHelp30.xsl" />
    <Content Include="transforms\seealso_dduexml.xsl" />
    <Content Include="transforms\skeleton.xml" />
    <Content Include="transforms\skeleton_conceptual.xml" />
    <Content Include="transforms\utilities_bibliography.xsl" />
    <Content Include="transforms\utilities_dduexml.xsl" />
    <Content Include="transforms\utilities_metadata.xsl" />
    <Content Include="transforms\utilities_reference.xsl" />
    <Content Include="transforms\web_reference.xsl" />
    <Content Include="transforms\xamlSyntax.xsl" />
    <Content Include="transforms\xpathFunctions.xsl" />
  </ItemGroup>
  <ItemGroup>
    <MshcZip Include="Branding\dev10\body.xslt" />
    <MshcZip Include="Branding\dev10\codesnippet-cs-CZ.xslt" />
    <MshcZip Include="Branding\dev10\codesnippet-de-DE.xslt" />
    <MshcZip Include="Branding\dev10\codesnippet-en-US.xslt" />
    <MshcZip Include="Branding\dev10\codesnippet-es-ES.xslt" />
    <MshcZip Include="Branding\dev10\codesnippet-fr-FR.xslt" />
    <MshcZip Include="Branding\dev10\codesnippet-it-IT.xslt" />
    <MshcZip Include="Branding\dev10\codesnippet-ja-JP.xslt" />
    <MshcZip Include="Branding\dev10\codesnippet-ko-KR.xslt" />
    <MshcZip Include="Branding\dev10\codesnippet-pl-PL.xslt" />
    <MshcZip Include="Branding\dev10\codesnippet-pt-BR.xslt" />
    <MshcZip Include="Branding\dev10\codesnippet-ru-RU.xslt" />
    <MshcZip Include="Branding\dev10\codesnippet-tr-TR.xslt" />
    <MshcZip Include="Branding\dev10\codesnippet-zh-CN.xslt" />
    <MshcZip Include="Branding\dev10\codesnippet-zh-TW.xslt" />
    <MshcZip Include="Branding\dev10\CodeSnippet.xslt" />
    <MshcZip Include="Branding\dev10\head.xslt" />
    <MshcZip Include="Branding\dev10\Identity.xslt" />
    <MshcZip Include="Branding\dev10\index-cs-CZ.xslt" />
    <MshcZip Include="Branding\dev10\index-de-DE.xslt" />
    <MshcZip Include="Branding\dev10\index-en-US.xslt" />
    <MshcZip Include="Branding\dev10\index-es-ES.xslt" />
    <MshcZip Include="Branding\dev10\index-fr-FR.xslt" />
    <MshcZip Include="Branding\dev10\index-it-IT.xslt" />
    <MshcZip Include="Branding\dev10\index-ja-JP.xslt" />
    <MshcZip Include="Branding\dev10\index-ko-KR.xslt" />
    <MshcZip Include="Branding\dev10\index-pl-PL.xslt" />
    <MshcZip Include="Branding\dev10\index-pt-BR.xslt" />
    <MshcZip Include="Branding\dev10\index-ru-RU.xslt" />
    <MshcZip Include="Branding\dev10\index-tr-TR.xslt" />
    <MshcZip Include="Branding\dev10\index-zh-CN.xslt" />
    <MshcZip Include="Branding\dev10\index-zh-TW.xslt" />
    <MshcZip Include="Branding\dev10\index.xslt" />
    <MshcZip Include="Branding\dev10\instrumentedlink-cs-CZ.xslt" />
    <MshcZip Include="Branding\dev10\instrumentedlink-de-DE.xslt" />
    <MshcZip Include="Branding\dev10\instrumentedlink-en-US.xslt" />
    <MshcZip Include="Branding\dev10\instrumentedlink-es-ES.xslt" />
    <MshcZip Include="Branding\dev10\instrumentedlink-fr-FR.xslt" />
    <MshcZip Include="Branding\dev10\instrumentedlink-it-IT.xslt" />
    <MshcZip Include="Branding\dev10\instrumentedlink-ja-JP.xslt" />
    <MshcZip Include="Branding\dev10\instrumentedlink-ko-KR.xslt" />
    <MshcZip Include="Branding\dev10\instrumentedlink-pl-PL.xslt" />
    <MshcZip Include="Branding\dev10\instrumentedlink-pt-BR.xslt" />
    <MshcZip Include="Branding\dev10\instrumentedlink-ru-RU.xslt" />
    <MshcZip Include="Branding\dev10\instrumentedlink-tr-TR.xslt" />
    <MshcZip Include="Branding\dev10\instrumentedlink-zh-CN.xslt" />
    <MshcZip Include="Branding\dev10\instrumentedlink-zh-TW.xslt" />
    <MshcZip Include="Branding\dev10\InstrumentedLink.xslt" />
    <MshcZip Include="Branding\dev10\LanguageSpecificText.xslt" />
    <MshcZip Include="Branding\dev10\MultiViewTable-cs-CZ.xslt" />
    <MshcZip Include="Branding\dev10\MultiViewTable-de-DE.xslt" />
    <MshcZip Include="Branding\dev10\MultiViewTable-en-US.xslt" />
    <MshcZip Include="Branding\dev10\MultiViewTable-es-ES.xslt" />
    <MshcZip Include="Branding\dev10\MultiViewTable-fr-FR.xslt" />
    <MshcZip Include="Branding\dev10\MultiViewTable-it-IT.xslt" />
    <MshcZip Include="Branding\dev10\MultiViewTable-ja-JP.xslt" />
    <MshcZip Include="Branding\dev10\MultiViewTable-ko-KR.xslt" />
    <MshcZip Include="Branding\dev10\MultiViewTable-pl-PL.xslt" />
    <MshcZip Include="Branding\dev10\MultiViewTable-pt-BR.xslt" />
    <MshcZip Include="Branding\dev10\MultiViewTable-ru-RU.xslt" />
    <MshcZip Include="Branding\dev10\MultiViewTable-tr-TR.xslt" />
    <MshcZip Include="Branding\dev10\MultiViewTable-zh-CN.xslt" />
    <MshcZip Include="Branding\dev10\MultiViewTable-zh-TW.xslt" />
    <MshcZip Include="Branding\dev10\MultiViewTable.xslt" />
    <MshcZip Include="Branding\dev10\search-cs-CZ.xslt" />
    <MshcZip Include="Branding\dev10\search-de-DE.xslt" />
    <MshcZip Include="Branding\dev10\search-en-US.xslt" />
    <MshcZip Include="Branding\dev10\search-es-ES.xslt" />
    <MshcZip Include="Branding\dev10\search-fr-FR.xslt" />
    <MshcZip Include="Branding\dev10\search-it-IT.xslt" />
    <MshcZip Include="Branding\dev10\search-ja-JP.xslt" />
    <MshcZip Include="Branding\dev10\search-ko-KR.xslt" />
    <MshcZip Include="Branding\dev10\search-pl-PL.xslt" />
    <MshcZip Include="Branding\dev10\search-pt-BR.xslt" />
    <MshcZip Include="Branding\dev10\search-ru-RU.xslt" />
    <MshcZip Include="Branding\dev10\search-tr-TR.xslt" />
    <MshcZip Include="Branding\dev10\search-zh-CN.xslt" />
    <MshcZip Include="Branding\dev10\search-zh-TW.xslt" />
    <MshcZip Include="Branding\dev10\search.xslt" />
    <MshcZip Include="Branding\dev10\toc-cs-CZ.xslt" />
    <MshcZip Include="Branding\dev10\toc-de-DE.xslt" />
    <MshcZip Include="Branding\dev10\toc-en-US.xslt" />
    <MshcZip Include="Branding\dev10\toc-es-ES.xslt" />
    <MshcZip Include="Branding\dev10\toc-fr-FR.xslt" />
    <MshcZip Include="Branding\dev10\toc-it-IT.xslt" />
    <MshcZip Include="Branding\dev10\toc-ja-JP.xslt" />
    <MshcZip Include="Branding\dev10\toc-ko-KR.xslt" />
    <MshcZip Include="Branding\dev10\toc-pl-PL.xslt" />
    <MshcZip Include="Branding\dev10\toc-pt-BR.xslt" />
    <MshcZip Include="Branding\dev10\toc-ru-RU.xslt" />
    <MshcZip Include="Branding\dev10\toc-tr-TR.xslt" />
    <MshcZip Include="Branding\dev10\toc-zh-CN.xslt" />
    <MshcZip Include="Branding\dev10\toc-zh-TW.xslt" />
    <MshcZip Include="Branding\dev10\toc.xslt" />
    <MshcZip Include="Branding\dev10\[Content_Types].xml" />
  </ItemGroup>
  <ItemGroup>
    <Folder Include="Properties\" />
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.Common.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
  <UsingTask TaskName="MshcZipMetadata" TaskFactory="CodeTaskFactory" AssemblyFile="$(MSBuildToolsPath)\Microsoft.Build.Tasks.v4.0.dll">
    <ParameterGroup>
      <SourceItems ParameterType="Microsoft.Build.Framework.ITaskItem[]" Required="true" />
      <OutputFile ParameterType="System.String" Output="true" />
    </ParameterGroup>
    <Task>
      <Code Type="Fragment" Language="cs"><![CDATA[
        foreach (var sourceItem in SourceItems)
        {
          Log.LogMessage("RelativeDir: {0}", sourceItem.GetMetadata("RelativeDir"));
          Log.LogMessage("OutputFile: {0}", sourceItem.GetMetadata("RelativeDir").TrimEnd('/', '\\') + ".mshc");
          OutputFile = sourceItem.GetMetadata("RelativeDir").TrimEnd('/', '\\') + ".mshc";
        }
        ]]></Code>
    </Task>
  </UsingTask>
  <UsingTask TaskName="ZipFiles" TaskFactory="CodeTaskFactory" AssemblyFile="$(MSBuildToolsPath)\Microsoft.Build.Tasks.v4.0.dll">
    <ParameterGroup>
      <InputFileNames ParameterType="Microsoft.Build.Framework.ITaskItem[]" Required="true" />
      <OutputFileName ParameterType="System.String" Required="true" />
      <OverwriteExistingFile ParameterType="System.Boolean" Required="false" />
    </ParameterGroup>
    <Task>
      <Reference Include="System.IO.Compression" />
      <Using Namespace="System.IO.Compression" />
      <Code Type="Fragment" Language="cs"><![CDATA[
        const int BufferSize = 64 * 1024;
 
        var buffer = new byte[BufferSize];
        var fileMode = OverwriteExistingFile ? FileMode.Create : FileMode.CreateNew;
 
        using (var outputFileStream = new FileStream(OutputFileName, fileMode))
        {
          using (var archive = new ZipArchive(outputFileStream, ZipArchiveMode.Create))
          {
            foreach (var inputFileName in InputFileNames.Select(f => f.ItemSpec))
            {
              var archiveEntry = archive.CreateEntry(Path.GetFileName(inputFileName));
 
              using (var fs = new FileStream(inputFileName, FileMode.Open))
              {
                using (var zipStream = archiveEntry.Open())
                {
                  int bytesRead = -1;
                  while ((bytesRead = fs.Read(buffer, 0, BufferSize)) > 0)
                  {
                    zipStream.Write(buffer, 0, bytesRead);
                  }
                }
              }
            }
          }
        }
      ]]></Code>
    </Task>
  </UsingTask>
  <Target Name="UpdateMshcZipMetadata" Outputs="%(MshcZip.RelativeDir)">
    <MshcZipMetadata SourceItems="%(MshcZip.RelativeDir)">
      <Output TaskParameter="OutputFile" PropertyName="_TempOutputFile" />
    </MshcZipMetadata>
    <ItemGroup>
      <MshcZip Condition="'%(MshcZip.RelativeDir)' == '%(RelativeDir)'">
        <OutputFile>$(_TempOutputFile)</OutputFile>
      </MshcZip>
    </ItemGroup>
    <!-- Clear the temporary property -->
    <PropertyGroup>
      <_TempOutputFiles>
      </_TempOutputFiles>
    </PropertyGroup>
  </Target>
  <Target Name="CompressMshcZip" DependsOnTargets="UpdateMshcZipMetadata" Outputs="@(MshcZip->'%(OutputFile)')">
    <MakeDir Directories="@(MshcZip->'%(RelativeDir)')" />
    <ZipFiles InputFileNames="@(MshcZip)" OutputFileName="%(OutputFile)" OverwriteExistingFile="true" />
  </Target>
  <Target Name="BeforeBuild" DependsOnTargets="CompressMshcZip">
  </Target>
</Project>