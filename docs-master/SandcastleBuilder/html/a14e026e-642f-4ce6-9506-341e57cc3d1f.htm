<html xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp"><head><META http-equiv="Content-Type" content="text/html; charset=utf-8"><link rel="SHORTCUT ICON" href="./../icons/favicon.ico"><link rel="stylesheet" type="text/css" href="./../styles/branding.css"><link rel="stylesheet" type="text/css" href="./../styles/branding-en-US.css"><style type="text/css">
			body
			{
			border-left:5px solid #e6e6e6;
			overflow-x:scroll;
			overflow-y:scroll;
			}
		</style><script src="./../scripts/branding.js" type="text/javascript"></script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Creating Build Process Plug-Ins</title><meta name="Language" content="en-us"><meta name="System.Keywords" content="plug-ins, creating a plug-in"><meta name="System.Keywords" content="plug-ins, execution notes"><meta name="System.Keywords" content="plug-ins, plug-in documentation"><meta name="System.Keywords" content="plug-ins, template class"><meta name="Microsoft.Help.Id" content="a14e026e-642f-4ce6-9506-341e57cc3d1f"><meta name="Description" content="The first step is to determine what items will appear in the plug-in configuration. The configuration is stored as an XML fragment in the help file builder project file. The root node is always configuration."><meta name="Microsoft.Help.ContentType" content="Concepts"><meta name="BrandingAware" content="'true'"><link type="text/css" rel="stylesheet" href="ms-help://Hx/HxRuntime/HxLink.css"><link type="text/css" rel="stylesheet" href="./../styles/highlight.css"><script type="text/javascript" src="../scripts/highlight.js"></script><meta name="SelfBranded" content="true"></head><body onload="onLoad()" class="primary-mtps-offline-document"><header class="ux-header"><div class="header-top-bar">Sandcastle Help File Builder Documentation</div></header><div class="OH_outerDiv" style="padding: 35px 20px 0 20px;"><div class="OH_leftNav" id="LeftNav">
  <div id="tocnav">
    <div class="toclevel0" data-toclevel="0" style="padding-left: 0px;"><a class="toc_collapsed" onclick="javascript: Toggle(this);" href="#!"></a><a data-tochassubtree="true" href="bd1ddb51-1c4f-434f-bb1a-ce2135d3a909.htm" title="Sandcastle Help File Builder" tocid="roottoc">Sandcastle Help File Builder</a></div><div class="toclevel1" data-toclevel="1" style="padding-left: 13px;" data-childrenloaded="true"><a class="toc_expanded" onclick="javascript: Toggle(this);" href="#!"></a><a data-tochassubtree="true" href="e031b14e-42f0-47e1-af4c-9fed2b88cbc7.htm" title="Build Process Plug-Ins" tocid="e031b14e-42f0-47e1-af4c-9fed2b88cbc7">Build Process Plug-Ins</a></div><div class="toclevel2" data-toclevel="2" style="padding-left: 26px;"><span class="toc_empty"></span><a data-tochassubtree="false" href="2d483967-30cb-421c-81ff-fdba705e1e6b.htm" title="Additional Content Only Plug-In" tocid="2d483967-30cb-421c-81ff-fdba705e1e6b">Additional Content Only Plug-In</a></div><div class="toclevel2" data-toclevel="2" style="padding-left: 26px;"><span class="toc_empty"></span><a data-tochassubtree="false" href="15b6b7be-3778-4487-b524-d558d02e6460.htm" title="Additional Reference Links Plug-In" tocid="15b6b7be-3778-4487-b524-d558d02e6460">Additional Reference Links Plug-In</a></div><div class="toclevel2" data-toclevel="2" style="padding-left: 26px;"><span class="toc_empty"></span><a data-tochassubtree="false" href="99773472-ff05-4eba-8194-b36a0536280e.htm" title="AjaxDoc Builder Plug-In" tocid="99773472-ff05-4eba-8194-b36a0536280e">AjaxDoc Builder Plug-In</a></div><div class="toclevel2" data-toclevel="2" style="padding-left: 26px;"><span class="toc_empty"></span><a data-tochassubtree="false" href="f5051d32-b973-4fe1-9ffe-e30531007691.htm" title="Assembly Binding Redirection Plug-In" tocid="f5051d32-b973-4fe1-9ffe-e30531007691">Assembly Binding Redirection Plug-In</a></div><div class="toclevel2" data-toclevel="2" style="padding-left: 26px;"><span class="toc_empty"></span><a data-tochassubtree="false" href="161537d9-6f89-42ef-9c51-3a15ef94df65.htm" title="Bibliography Support Plug-In" tocid="161537d9-6f89-42ef-9c51-3a15ef94df65">Bibliography Support Plug-In</a></div><div class="toclevel2" data-toclevel="2" style="padding-left: 26px;"><span class="toc_empty"></span><a data-tochassubtree="false" href="d0ac3f31-bc25-4c5a-b2e6-d64a74fdb67c.htm" title="Completion Notification Plug-In" tocid="d0ac3f31-bc25-4c5a-b2e6-d64a74fdb67c">Completion Notification Plug-In</a></div><div class="toclevel2" data-toclevel="2" style="padding-left: 26px;"><span class="toc_empty"></span><a data-tochassubtree="false" href="31696f39-8f4e-4c4d-ab08-41a40793df03.htm" title="DBCS Fix for CHM Builds Plug-In" tocid="31696f39-8f4e-4c4d-ab08-41a40793df03">DBCS Fix for CHM Builds Plug-In</a></div><div class="toclevel2" data-toclevel="2" style="padding-left: 26px;"><span class="toc_empty"></span><a data-tochassubtree="false" href="aa7bcd07-1a86-42dc-9f1d-49bd4afeb5d2.htm" title="Hierarchical Table of Contents Plug-In" tocid="aa7bcd07-1a86-42dc-9f1d-49bd4afeb5d2">Hierarchical Table of Contents Plug-In</a></div><div class="toclevel2" data-toclevel="2" style="padding-left: 26px;"><span class="toc_empty"></span><a data-tochassubtree="false" href="936f1b06-063e-4ffc-8999-0f7c9bd49e03.htm" title="Lightweight Table of Contents Plug-In" tocid="936f1b06-063e-4ffc-8999-0f7c9bd49e03">Lightweight Table of Contents Plug-In</a></div><div class="toclevel2" data-toclevel="2" style="padding-left: 26px;"><span class="toc_empty"></span><a data-tochassubtree="false" href="796d6bbe-5130-4c87-8790-5cceb66219c7.htm" title="Output Deployment Plug-In" tocid="796d6bbe-5130-4c87-8790-5cceb66219c7">Output Deployment Plug-In</a></div><div class="toclevel2" data-toclevel="2" style="padding-left: 26px;"><span class="toc_empty"></span><a data-tochassubtree="false" href="93c452fd-71d4-470e-8d27-ec3d979679a4.htm" title="Script# Reflection File Fixer Plug-In" tocid="93c452fd-71d4-470e-8d27-ec3d979679a4">Script# Reflection File Fixer Plug-In</a></div><div class="toclevel2" data-toclevel="2" style="padding-left: 26px;"><span class="toc_empty"></span><a data-tochassubtree="false" href="d0e91b66-135e-446b-9239-c02fcafabd09.htm" title="Table of Contents Exclusion Plug-In" tocid="d0e91b66-135e-446b-9239-c02fcafabd09">Table of Contents Exclusion Plug-In</a></div><div class="toclevel2" data-toclevel="2" style="padding-left: 26px;"><span class="toc_empty"></span><a data-tochassubtree="false" href="6c03afba-18d0-4270-b521-c2015c4d97b3.htm" title="Version Builder Plug-In" tocid="6c03afba-18d0-4270-b521-c2015c4d97b3">Version Builder Plug-In</a></div><div class="toclevel2" data-toclevel="2" style="padding-left: 26px;"><span class="toc_empty"></span><a data-tochassubtree="false" href="96557037-c19e-4183-bcf1-f42d7018de9f.htm" title="Wildcard References Plug-In" tocid="96557037-c19e-4183-bcf1-f42d7018de9f">Wildcard References Plug-In</a></div><div class="toclevel2" data-toclevel="2" style="padding-left: 26px;"><span class="toc_empty"></span><a data-tochassubtree="false" href="cd68ef02-3493-4af6-96de-1957b0aaf858.htm" title="XPath Reflection File Filter Plug-In" tocid="cd68ef02-3493-4af6-96de-1957b0aaf858">XPath Reflection File Filter Plug-In</a></div><div class="toclevel2 current" data-toclevel="2" style="padding-left: 26px;"><span class="toc_empty"></span><a data-tochassubtree="false" href="a14e026e-642f-4ce6-9506-341e57cc3d1f.htm" title="Creating Build Process Plug-Ins" tocid="a14e026e-642f-4ce6-9506-341e57cc3d1f">Creating Build Process Plug-Ins</a></div></div></div><div id="TocResize" class="OH_TocResize"><img id="ResizeImageIncrease" src="../icons/open.gif" onclick="onIncreaseToc()" alt="Expand" title="Expand"><img id="ResizeImageReset" src="../icons/close.gif" style="display:none" onclick="onResetToc()" alt="Minimize" title="Minimize"></div><div class="OH_outerContent" id="OuterContent" style="margin-left: 280px;"><h1 class="title">Creating Build Process Plug-Ins</h1><div id="mainSection"><div id="mainBody"><span class="introStyle"></span><div class="introduction"><p>This topic will walk you through the creation of a plug-in project.</p><ul class="autoOutline"><li class="outlineSectionEntry"><a href="#DefineConfig" target="">Defining the Plug-In Configuration</a></li><li class="outlineSectionEntry"><a href="#CreateProject" target="">Creating the Project</a></li><li class="outlineSectionEntry"><a href="#Template" target="">The Plug-In Template Class</a></li><li class="outlineSectionEntry"><a href="#Metadata" target="">The Export Attribute Metadata</a></li><ul class="autoOutline"><li class="outlineSectionEntry"><a href="#MetadataId" target="">Id</a></li><li class="outlineSectionEntry"><a href="#MetadataVersion" target="">Version</a></li><li class="outlineSectionEntry"><a href="#MetadataCopyright" target="">Copyright</a></li><li class="outlineSectionEntry"><a href="#MetadataDescription" target="">Description</a></li><li class="outlineSectionEntry"><a href="#MetadataRunsInPartialBuild" target="">RunsInPartialBuild</a></li><li class="outlineSectionEntry"><a href="#MetadataIsConfigurable" target="">IsConfigurable</a></li></ul><li class="outlineSectionEntry"><a href="#Interface" target="">The Plug-In Interface</a></li><ul class="autoOutline"><li class="outlineSectionEntry"><a href="#ExecutionPoints" target="">ExecutionPoints</a></li><li class="outlineSectionEntry"><a href="#ConfigurePlugIn" target="">ConfigurePlugIn</a></li><li class="outlineSectionEntry"><a href="#Initialize" target="">Initialize</a></li><li class="outlineSectionEntry"><a href="#Execute" target="">Execute</a></li><li class="outlineSectionEntry"><a href="#Dispose" target="">Finalizer and Dispose</a></li></ul><li class="outlineSectionEntry"><a href="#ExecNotes" target="">Execution Notes</a></li></ul></div><a id="DefineConfig"></a><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Defining the Plug-In Configuration</div></div><p>The first step is to determine what items will appear in the plug-in configuration.  The
configuration is stored as an XML fragment in the help file builder project file.  The root node is always
<span class="code">configuration</span>.  Define your own elements to contain the plug-in configuration that will
be nested within the root element.  When first added to a project, the configuration will be empty.  Your plug-in
should use appropriate default values as needed.  It is possible that a plug-in will have no configurable
elements.  In that case, there is nothing to add to the default configuration.  Below is an example of a
configuration that is passed to a plug-in.</p><div id="ID0EAMAAAAA" class="codeSnippetContainer"><div class="codeSnippetContainerTabs" id="ID0EAMAAAAA_tabs"><div id="ID0EAMAAAAA_tab1" class="codeSnippetContainerTabSingle" dir="ltr" EnableCopyCode="true"><a xmlns="">Example Plug-In Configuration</a></div></div><div id="ID0EAMAAAAA_codecollection" class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAMAAAAA_ViewColorized" href="#" onclick="javascript:ExchangeTitleContent('ID0EAMAAAAA','4')" title="View Colorized" style="display: none">View Colorized</a><a id="ID0EAMAAAAA_copycode" href="#" onclick="javascript:CopyToClipboard('ID0EAMAAAAA','4')" title="Copy to Clipboard">Copy to Clipboard</a><a id="ID0EAMAAAAA_PrintText" class="OH_PrintText" href="#" onclick="javascript:Print('ID0EAMAAAAA','4')" title="Print">Print</a></div></div><div id="ID0EAMAAAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre><span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">configuration</span><span class="highlight-xml-bracket">&gt;</span> 
  <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">ajaxDoc</span> <span class="highlight-xml-attribute-name">url</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"http://localhost:/AjaxDoc/"</span> <span class="highlight-xml-attribute-name">project</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"MicrosoftAjax"</span> <span class="highlight-xml-attribute-name">regenerate</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"true"</span> <span class="highlight-xml-bracket">/&gt;</span> 
  <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">userCredentials</span> <span class="highlight-xml-attribute-name">useDefault</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"true"</span> <span class="highlight-xml-attribute-name">userName</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">""</span> <span class="highlight-xml-attribute-name">password</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">""</span> <span class="highlight-xml-bracket">/&gt;</span> 
  <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">proxyCredentials</span> <span class="highlight-xml-attribute-name">useProxy</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"false"</span> <span class="highlight-xml-attribute-name">proxyServer</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">""</span><span class="highlight-xml-bracket">&gt;</span> 
    <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">userCredentials</span> <span class="highlight-xml-attribute-name">useDefault</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"true"</span> <span class="highlight-xml-attribute-name">userName</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">""</span> <span class="highlight-xml-attribute-name">password</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">""</span> <span class="highlight-xml-bracket">/&gt;</span> 
  <span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">proxyCredentials</span><span class="highlight-xml-bracket">&gt;</span> 
<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">configuration</span><span class="highlight-xml-bracket">&gt;</span></pre></div><div id="ID0EAMAAAAA_code_Plain_Div1" class="codeSnippetContainerCode" style="display: none"><pre>&lt;configuration&gt; 
  &lt;ajaxDoc url="http://localhost:/AjaxDoc/" project="MicrosoftAjax" regenerate="true" /&gt; 
  &lt;userCredentials useDefault="true" userName="" password="" /&gt; 
  &lt;proxyCredentials useProxy="false" proxyServer=""&gt; 
    &lt;userCredentials useDefault="true" userName="" password="" /&gt; 
  &lt;/proxyCredentials&gt; 
&lt;/configuration&gt;</pre></div></div></div><script>addSpecificTextLanguageTagSet('ID0EAMAAAAA');</script><a id="CreateProject"></a><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Creating the Project</div></div><p>This section describes how to create and configure the build process plug-in project.  It will
describe the process for a C# project but the steps should be fairly similar for a VB.NET project with a few
differences in the configuration option titles.</p><h3 class="procedureSubHeading">Create the Plug-In Project</h3><div class="subSection"><ol><li><p>In Visual Studio, select the <span class="ui">New Project</span> option.  In the <span class="ui">New Project</span>
dialog box, select the C# or VB.NET language, and then select the <span class="ui">Documentation</span> subcategory.  Select
the <span class="ui">Sandcastle Help File Builder Plug-In</span> template, give it a name and click <span class="ui">OK</span> to create it.
Once it has been created, right click on the project and select <span class="ui">Properties</span>.</p></li><li><p>In the <span class="ui">Application</span> tab, set the assembly name and default namespace as you see fit.</p></li><li><p>On the <span class="ui">Debug</span> tab, set the <span class="ui">Start Action</span> to "Start external program" and
enter the path to the <em>SandcastleBuilderGUI.exe</em> program.  If you installed the help file
builder in the default location, this will be <em>%ProgramFiles(x86)%\EWSoftware\Sandcastle Help File
Builder\</em>.  If not, substitute your path as appropriate.</p><div class="alert"><table><tr><th><img class="mtps-img-src" src="./../icons/alert_note.gif" alt="Tip"> <strong>Tip</strong></th></tr><tr><td><p>Using the standalone GUI as the host is easier than using Visual Studio as the package
locks the assemblies once the help file builder project has loaded them for use and you will not be able to
rebuild them.  Shutting down the standalone GUI frees the assemblies so that you can rebuild them and start a new
debugging session.</p><p>In the help file builder project that you use to test your plug-in, set the project's
<span class="code">Component Path</span> property to the folder containing your plug-in's assembly.  If you have
opened the project's <span class="ui">Plug-Ins</span> property page before setting the component path, you may need to close and
reopen the project in order for it to discover your plug-in assembly.</p></td></tr></table></div></li><li><p>Optionally, select the <span class="ui">Signing</span> tab and check the "Sign the assembly" checkbox.
Select "&lt;New...&gt;" from the "Choose a strong name key file" dropdown, enter a filename, and click OK to
create the key file.  You can protect the key file with a password if you like or uncheck the option to create
one without a password.</p></li></ol></div><a id="Template"></a><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">The Plug-In Template Class</div></div><p>You are now ready to edit the plug-in class itself.  See the comments in the template class for
information on how to get started.  Some general information is given below.  Note that multiple plug-ins can
reside within the same assembly.  Add new class files to the project and implement the necessary methods as
described below and as shown in the template class.</p><p>The plug-in is derived from the
<span sdata="cer" target="T:SandcastleBuilder.Utils.BuildComponent.IPlugIn"><a href="bcf36919-1d66-1625-544e-adb51877d5de.htm" target="">SandcastleBuilder.Utils.BuildComponent<span id="ID0EBAHAIAAAAA"> </span><script type="text/javascript">
					addToLanSpecTextIdSet("ID0EBAHAIAAAAA?vb=.|cpp=::|cs=.|fs=.|nu=.");
				</script>IPlugIn</a></span>
interface and consists of a few properties and methods that you must implement.  These are described below.
Review the code for "<span class="code">TODO:</span>" comments to find sections that need attention such as
setting the plug-in's ID, defining the execution points, etc.  If you followed the steps in the
<strong>Creating the Project</strong> section, you can run the project and debug it by setting
breakpoints in the plug-in's code.  As noted above, set the test project's <span class="code">Component Path</span>
property to the folder containing the plug-in assembly first.  If necessary, close and reopen the test project
so that it can discover the plug-in.</p><a id="Metadata"></a><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">The Export Attribute Metadata</div></div><p>The plug-in is a Managed Extensibility Framework (MEF) component.  The
<span sdata="cer" target="T:SandcastleBuilder.Utils.BuildComponent.HelpFileBuilderPlugInExportAttribute"><a href="a4e1e642-d901-b458-8cf5-a393970e0150.htm" target="">HelpFileBuilderPlugInExportAttribute</a></span>
is used to define the necessary metadata that enables the help file builder to load and use the component.</p><a id="MetadataId"></a><h4 class="subHeading">Id</h4><div class="subsection"><p>The <span class="code">Id</span> parameter is required and is used to uniquely identify the
plug-in.</p></div><a id="MetadataVersion"></a><h4 class="subHeading">Version</h4><div class="subsection"><p>The <span class="code">Version</span> property is optional and allows you to define the plug-in
version displayed in the help file builder property page when the plug-in is selected.</p></div><a id="MetadataCopyright"></a><h4 class="subHeading">Copyright</h4><div class="subsection"><p>The <span class="code">Copyright</span> property is optional and allows you to define the
plug-in copyright displayed in the help file builder property page when the plug-in is selected.</p></div><a id="MetadataDescription"></a><h4 class="subHeading">Description</h4><div class="subsection"><p>The <span class="code">Description</span> property is optional and allows you to define the
plug-in description displayed in the help file builder property page when the plug-in is selected.</p></div><a id="MetadataRunsInPartialBuild"></a><h4 class="subHeading">RunsInPartialBuild</h4><div class="subsection"><p>The <span class="code">RunsInPartialBuild</span> property is optional and allows you to define
whether or not the plug-in runs during a partial build.  Partial builds occur when generating the reflection data
for the namespace comments and API filter editor dialogs.  In such cases, the plug-in may not be needed.  If this
property returns false, the default, the plug-in is omitted which can speed up the partial build.  Set it to true
if your plug-in adds information needed for the reflection data or namespace comments.</p></div><a id="MetadataIsConfigurable"></a><h4 class="subHeading">IsConfigurable</h4><div class="subsection"><p>The <span class="code">IsConfigurable</span> property is optional and allows you to define
whether or not the plug-in supports interactive editing of its configuration.  If false, the default, the
plug-in will not be configurable from the property page.  If true, the property page will call the
<span class="code">ConfigurePlugIn</span> method so that it can invoke a dialog box to edit the configuration.</p></div><a id="Interface"></a><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">The Plug-In Interface</div></div><p>The interface consists of one property and four methods.</p><a id="ExecutionPoints"></a><h4 class="subHeading">ExecutionPoints</h4><div class="subsection"><p>The <span class="code">ExecutionPoints</span> property is probably the most important member of
the interface.  It returns a collection of
<span sdata="cer" target="T:SandcastleBuilder.Utils.BuildComponent.ExecutionPoint"><a href="64518f52-884e-3d57-eed5-1760625be48b.htm" target="">ExecutionPoint</a></span>
objects that define at which steps in the build process the plug-in should be ran.  Execution points can be set
to run before and/or after a build step to supplement the default processing or they can be set to run instead of
the build step to completely suppress or replace the default processing.  See the
<span sdata="cer" target="T:SandcastleBuilder.Utils.BuildEngine.BuildStep"><a href="15b1ab7a-6438-34c6-e592-a46320ab5e97.htm" target="">BuildStep</a></span>
enumeration for a list of the defined build steps.</p><p>Each execution point can be assigned a priority.  The execution priority is used to determine
the order in which the plug-ins will be executed.  Those with a higher priority value will be executed before
those with a lower value.  Those with an identical priority may be executed in any order within their group.  If
not specified, a default priority of 1,000 is used.</p></div><a id="ConfigurePlugIn"></a><h4 class="subHeading">ConfigurePlugIn</h4><div class="subsection"><p>The <span class="code">ConfigurePlugIn</span> method is used to configure the plug-in
interactively from within the help file builder.  The method is passed a string containing the XML fragment that
defines the current configuration. It should return a copy of the edited configuration.</p></div><a id="Initialize"></a><h4 class="subHeading">Initialize</h4><div class="subsection"><p>The <span class="code">Initialize</span> method is used to initialize the plug-in at the start
of the build process.  It is passed a reference to the current
<span sdata="cer" target="T:SandcastleBuilder.Utils.BuildEngine.BuildProcess"><a href="6c4dd5b1-16bc-6cc8-25b7-80073d1a7285.htm" target="">BuildProcess</a></span>
and an XPath navigator containing the plug-in configuration.  You should cache a copy of the build process
reference for use during execution as it contains many properties and methods that you will find useful.</p></div><a id="Execute"></a><h4 class="subHeading">Execute</h4><div class="subsection"><p>The <span class="code">Execute</span> method is called to perform the plug-in processing during
the relevant build steps.  It is passed an
<span sdata="cer" target="T:SandcastleBuilder.Utils.BuildComponent.ExecutionContext"><a href="46ba727d-2cb2-e0a7-bd60-2c5723785c3f.htm" target="">SandcastleBuilder.Utils.BuildComponent<span id="ID0EBAFADEAAAAA"> </span><script type="text/javascript">
					addToLanSpecTextIdSet("ID0EBAFADEAAAAA?vb=.|cpp=::|cs=.|fs=.|nu=.");
				</script>ExecutionContext</a></span>
object that defines the current execution context.  If your plug-in determines that it does not need to run, it
should set the <span sdata="cer" target="P:SandcastleBuilder.Utils.BuildComponent.ExecutionContext.Executed"><a href="c6d9b694-2d01-43d6-b1ad-6c5e31a3acf9.htm" target="">ExecutionContext<span id="ID0EBADADEAAAAA"> </span><script type="text/javascript">
					addToLanSpecTextIdSet("ID0EBADADEAAAAA?vb=.|cpp=::|cs=.|fs=.|nu=.");
				</script>Executed</a></span>
property to false.  This is especially important for plug-ins with the <span class="code">InsteadOf</span>
behavior. If none run, the default processing will occur.</p></div><a id="Dispose"></a><h4 class="subHeading">Finalizer and Dispose</h4><div class="subsection"><p>The <span class="code">Dispose</span> method can be used to dispose of any resources used during
the build process.  If you do not have any resources that need to be disposed of, this method can be left as
it is and the finalizer method can be removed.</p></div><a id="ExecNotes"></a><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Execution Notes</div></div><p>There are certain conditions to be aware of when choosing and coding the execution behavior for
your plug-in.</p><ul><li><p>The earliest execution point for a plug-in is the <span class="code">After</span> behavior with
the <span class="code">Initializing</span> step.</p></li><li><p>The <span class="code">Before</span> behavior cannot be used with the <span class="code">Initializing</span>,
<span class="code">Canceled</span>, or <span class="code">Failed</span> steps.</p></li><li><p>The <span class="code">InsteadOf</span> behavior cannot be used with the <span class="code">Initializing</span>,
<span class="code">Completed</span>, <span class="code">Canceled</span>, or <span class="code">Failed</span> steps.</p></li><li><p>The <span class="code">InsteadOf</span> behavior always takes precedence.  The build process
will not call any plug-ins with <span class="code">Before</span> or <span class="code">After</span> behavior for
the step if an <span class="code">InsteadOf</span> plug-in runs.  As such, it is up to the plug-in with the
<span class="code">InsteadOf</span> behavior to call the
<span sdata="cer" target="M:SandcastleBuilder.Utils.BuildEngine.BuildProcess.ExecuteBeforeStepPlugIns"><a href="a9cb2f26-d086-0d83-aa5d-829350e2a2ce.htm" target="">ExecuteBeforeStepPlugIns</a></span>
and <span sdata="cer" target="M:SandcastleBuilder.Utils.BuildEngine.BuildProcess.ExecuteAfterStepPlugIns"><a href="dc79407c-a2be-eec9-9523-f73e384e0e6a.htm" target="">ExecuteAfterStepPlugIns</a></span>
methods to run them if needed.
						</p></li><li><p>If the build step involves creating, modifying, or deleting a non-script file or folder, the
<span class="code">Before</span> behavior is always executed prior to creating/modifying/deleting the file or
folder.  Use the <span class="code">After</span> behavior if you need to guarantee that the file or folder exists
or you do not want your version overwritten.  The exceptions to this rule are MSBuild project files
(<em>*.proj</em>) and <em>MRefBuilder.config</em> which are always created prior to
running the <span class="code">Before</span> behavior plug-ins.  This allows you to modify the script files prior
to them being ran.</p></li><li><p>If the build step involves creating, modifying, or deleting a script file or folder and the
<span class="code">InsteadOf</span> behavior is used, the plug-in is responsible for creating the script
file/folder.  All normal processing involving the file/folder including its creation is skipped.</p></li><li><p>The <span class="code">GenerateHelpFormatTableOfContents</span>,
<span class="code">GenerateHelpFileIndex</span>, <span class="code">GenerateHelpProject</span>,
<span class="code">UpdateTableOfContents</span>, and <span class="code">CompilingHelpFile</span> steps will run
once for each help file format selected.  You can use the
<span sdata="cer" target="P:SandcastleBuilder.Utils.BuildEngine.BuildProcess.CurrentFormat"><a href="d66c5dfc-d078-2272-cff0-c039b108d818.htm" target="">CurrentFormat</a></span>
property to determine the current help file format being built in order to skip or alter the plug-in's processing
based on the help file format.</p></li><li><p>Be aware that the HTML Help 1 index and table of contents files and the website table of
contents file are actually generated as part of the <span class="code">ExtractHtmlInfo</span> step.  However, the
before and after plug-in behaviors for the index and table of contents steps in each of those formats will still
be executed.</p></li></ul><a name="seeAlsoSection"></a><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">See Also</div></div><h4 class="subHeading">Other Resources</h4><div class="seeAlsoStyle"><a href="e031b14e-42f0-47e1-af4c-9fed2b88cbc7.htm" target="">Build Process Plug-Ins</a></div></div></div></div></div><div id="OH_footer" class="OH_footer"><p><a href="http://SHFB.CodePlex.com" target="_blank">[v2014.2.15.0] Copyright © 2006-2014, Eric Woodruff, All rights reserved (http://SHFB.CodePlex.com)</a></p><div class="OH_feedbacklink"><a href="mailto:Eric@EWoodruff.us?subject=Sandcastle+Help+File+Builder+Documentation+Creating+Build+Process+Plug-Ins+100+EN-US&amp;body=Your%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report%2c%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed%2c%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.">Send Feedback</a> on this topic to Eric Woodruff.</div></div><script src="//code.jquery.com/jquery-1.11.0.min.js"></script><script type="text/javascript">$(document).ready(function () {DocumentReady();});</script></body></html>