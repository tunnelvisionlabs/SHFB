<!DOCTYPE html ><html><head><META http-equiv="Content-Type" content="text/html; charset=utf-8"><meta charset="utf-8"><link rel="shortcut icon" href="../icons/favicon.ico"><link rel="stylesheet" type="text/css" href="../styles/branding.css"><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css"><script type="text/javascript" src="../scripts/branding.js"> </script><title>Deploying an MS Help 2 File</title><meta name="Language" content="en-us"><meta name="System.Keywords" content="deployment, MS Help 2"><meta name="System.Keywords" content="HXS"><meta name="System.Keywords" content="MS Help 2"><meta name="Microsoft.Help.Id" content="68a2fa4e-c6de-47ed-a9a6-60cc6ef01df4"><meta name="Description" content="The MS Help 2 system maintains a registry of all help collections and titles currently installed on a machine. This registry determines what help titles are included in each help collection as well as maintaining references between the help collections."><meta name="Microsoft.Help.ContentType" content="Concepts"><meta name="BrandingAware" content="true"><link type="text/css" rel="stylesheet" href="../styles/highlight.css"><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css"><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle"><div class="pageHeader" id="PageHeader">Sandcastle Help File Builder Documentation<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!"></a><a data-tochassubtree="true" href="bd1ddb51-1c4f-434f-bb1a-ce2135d3a909.htm" title="Sandcastle Help File Builder Documentation" tocid="roottoc">Sandcastle Help File Builder Documentation</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!"></a><a data-tochassubtree="true" href="e32086c6-de17-4e54-a746-1ac80bf0c45a.htm" title="Project Properties Window" tocid="e32086c6-de17-4e54-a746-1ac80bf0c45a">Project Properties Window</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!"></a><a data-tochassubtree="true" href="d0c2dabd-3caf-4586-b81d-cbd765dec7cf.htm" title="MS Help 2 Category Properties" tocid="d0c2dabd-3caf-4586-b81d-cbd765dec7cf">MS Help 2 Category Properties</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="74664b00-b83f-450a-833a-25984ba812e3.htm" title="Named URL Index Support" tocid="74664b00-b83f-450a-833a-25984ba812e3">Named URL Index Support</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="68a2fa4e-c6de-47ed-a9a6-60cc6ef01df4.htm" title="Deploying an MS Help 2 File" tocid="68a2fa4e-c6de-47ed-a9a6-60cc6ef01df4">Deploying an MS Help 2 File</a></div></div><div id="TocResizableEw" class="tocResizableEw" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize"><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize"></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img alt="Sandcastle Help File Builder" width="70" height="68" src="../icons/Sandcastle.jpg"></td><td class="titleColumn">Deploying an MS Help 2 File</td></tr></table><span class="introStyle"></span><div class="introduction"><p>The MS Help 2 system maintains a registry of all help collections and titles currently installed on a
machine.  This registry determines what help titles are included in each help collection as well as maintaining
references between the help collections.</p></div><div id="ID1RBSection" class="collapsibleSection"><p>Unlike HTML Help 1 (CHM) files, an MS Help 2 title or collection must be registered in order to view
it. This makes deploying HTML Help 2 documentation more complex than simply delivering a single file and creating
a shortcut to it.  While it is possible to create a Windows Installer package to deploy and register help
collections and titles, it is a rather lengthy process and it does not always work as well as it should.</p><p>The easiest approach to deploying and registering Help 2 collections is to use the shareware tool
<a href="http://www.helpware.net/mshelp2/h2reg.htm" target="_blank">H2Reg.exe</a> from <a href="http://www.helpware.net" target="_blank">The Helpware Group</a>.  It is a command line tool that can be included by scripted installers as well as Windows
Installer packages as a custom action.</p><p>When producing an MS Help 2 file, the help file builder produces a valid set of collection files and
creates a configuration file suitable for use by <em>H2Reg.exe</em>.  In order to deploy the
generated HTML Help 2 files, follow these steps:</p><ol><li><p>Set the <span class="code">Plug In Namespaces</span> project property to a comma separated list of
one or more namespaces that your collection should be plugged into when deployed.  The default setting will plug
it into all available collections.  See the <em>H2Reg.exe</em> help file for details about the
possible values that can be used.</p></li><li><p>Build the help project.</p></li><li><p>Include all of the generated help files as well as the generated configuration file and the
<em>H2Reg.exe</em> executable in your installer.</p></li><li><p>During installation, copy the help files, the configuration file, and <em>H2Reg.exe</em>
to their installed location.</p></li><li><p>Execute <em>H2Reg.exe</em> with the following syntax:</p><div class="codeSnippetContainer"><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAABDABAAA_copyCode" href="#" onclick="javascript:CopyToClipboard('ID0EAABDABAAA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAABDABAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">H2Reg -r "CmdFile=&lt;Path to the configuration file&gt;"</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAABDABAAA");</script></li><li><p>During uninstallation, before the help files are removed, execute <em>H2Reg.exe</em>
with the following syntax:</p><div class="codeSnippetContainer"><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAAADABAAA_copyCode" href="#" onclick="javascript:CopyToClipboard('ID0EAAADABAAA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAAADABAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">H2Reg -u "CmdFile=&lt;Path to the configuration file&gt;"</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAAADABAAA");</script></li></ol><p>Your product's installer can create a shortcut to open your Help 2 file by executing a command similar
to the following (lines wrapped for display purposes):</p><div class="codeSnippetContainer"><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EABABAAA_copyCode" href="#" onclick="javascript:CopyToClipboard('ID0EABABAAA');return false;" title="Copy">Copy</a></div></div><div id="ID0EABABAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">"%CommonProgramFiles%\Microsoft Shared\Help 9\dexplore.exe" /helpcol ms-help://MS.VSCC.v90
  /filter "[Your help title here]"</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EABABAAA");</script><p>Substitute your product's help title project property value for "[Your help title here]" in the
example above.</p></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png">See Also</span></div><div id="ID2RBSection" class="collapsibleSection"><h4 class="subHeading">Other Resources</h4><div class="seeAlsoStyle"><a href="74664b00-b83f-450a-833a-25984ba812e3.htm">Named URL Index Support</a></div><div class="seeAlsoStyle"><a href="d0c2dabd-3caf-4586-b81d-cbd765dec7cf.htm">MS Help 2 Category Properties</a></div></div></div></div><div id="pageFooter" class="pageFooter"><p><a href="http://SHFB.CodePlex.com" target="_blank">[v2014.4.22.0] Copyright © 2006-2014, Eric Woodruff, All rights reserved</a></p><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:Eric%40EWoodruff.us?Subject=Sandcastle Help File Builder Documentation">Eric Woodruff</a></div><script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script></div></body></html>