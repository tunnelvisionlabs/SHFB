<html><head><META http-equiv="Content-Type" content="text/html; charset=utf-8"><link rel="shortcut icon" href="../icons/favicon.ico"><link rel="stylesheet" type="text/css" href="../styles/branding.css"><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css"><script type="text/javascript" src="../scripts/branding.js"></script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Deploying an MS Help 2 File</title><meta name="Language" content="en-us"><meta name="System.Keywords" content="deployment, MS Help 2"><meta name="System.Keywords" content="HXS"><meta name="System.Keywords" content="MS Help 2"><meta name="Microsoft.Help.Id" content="68a2fa4e-c6de-47ed-a9a6-60cc6ef01df4"><meta name="Description" content="The MS Help 2 system maintains a registry of all help collections and titles currently installed on a machine. This registry determines what help titles are included in each help collection as well as maintaining references between the help collections."><meta name="Microsoft.Help.ContentType" content="Concepts"><meta name="BrandingAware" content="'true'"><link type="text/css" rel="stylesheet" href="../styles/highlight.css"><script type="text/javascript" src="../scripts/highlight.js"></script><meta name="SelfBranded" content="true"></head><body onload="onLoad()"><header class="ux-header"><div class="header-top-bar">Sandcastle Help File Builder Documentation</div></header><div class="OH_outerDiv" style="padding: 35px 20px 0 20px;"><div class="OH_leftNav" id="LeftNav">
  <div id="tocnav">
    <div class="toclevel0" data-toclevel="0" style="padding-left: 0px;"><a class="toc_collapsed" onclick="javascript: Toggle(this);" href="#!"></a><a data-tochassubtree="true" href="bd1ddb51-1c4f-434f-bb1a-ce2135d3a909.htm" title="Sandcastle Help File Builder" tocid="roottoc">Sandcastle Help File Builder</a></div><div class="toclevel0" data-toclevel="0" style="padding-left: 0px;"><a class="toc_collapsed" onclick="javascript: Toggle(this);" href="#!"></a><a data-tochassubtree="true" href="e32086c6-de17-4e54-a746-1ac80bf0c45a.htm" title="Project Properties Window" tocid="e32086c6-de17-4e54-a746-1ac80bf0c45a">Project Properties Window</a></div><div class="toclevel1" data-toclevel="1" style="padding-left: 13px;" data-childrenloaded="true"><a class="toc_expanded" onclick="javascript: Toggle(this);" href="#!"></a><a data-tochassubtree="true" href="d0c2dabd-3caf-4586-b81d-cbd765dec7cf.htm" title="MS Help 2 Category Properties" tocid="d0c2dabd-3caf-4586-b81d-cbd765dec7cf">MS Help 2 Category Properties</a></div><div class="toclevel2" data-toclevel="2" style="padding-left: 26px;"><span class="toc_empty"></span><a data-tochassubtree="false" href="74664b00-b83f-450a-833a-25984ba812e3.htm" title="Named URL Index Support" tocid="74664b00-b83f-450a-833a-25984ba812e3">Named URL Index Support</a></div><div class="toclevel2 current" data-toclevel="2" style="padding-left: 26px;"><span class="toc_empty"></span><a data-tochassubtree="false" href="68a2fa4e-c6de-47ed-a9a6-60cc6ef01df4.htm" title="Deploying an MS Help 2 File" tocid="68a2fa4e-c6de-47ed-a9a6-60cc6ef01df4">Deploying an MS Help 2 File</a></div></div></div><div id="TocResize" class="OH_TocResize"><img id="ResizeImageIncrease" src="../icons/open.gif" onclick="onIncreaseToc()" alt="Expand" title="Expand"><img id="ResizeImageReset" src="../icons/close.gif" style="display:none" onclick="onResetToc()" alt="Minimize" title="Minimize"></div><div class="OH_outerContent" id="OuterContent" style="margin-left: 280px;"><h1 class="title">Deploying an MS Help 2 File</h1><div id="mainSection"><div id="mainBody"><span class="introStyle"></span><div class="introduction"><p>The MS Help 2 system maintains a registry of all help collections and titles currently installed on a
machine.  This registry determines what help titles are included in each help collection as well as maintaining
references between the help collections.</p></div><p>Unlike HTML Help 1 (CHM) files, an MS Help 2 title or collection must be registered in order to view
it. This makes deploying HTML Help 2 documentation more complex than simply delivering a single file and creating
a shortcut to it.  While it is possible to create a Windows Installer package to deploy and register help
collections and titles, it is a rather lengthy process and it does not always work as well as it should.</p><p>The easiest approach to deploying and registering Help 2 collections is to use the shareware tool
<a href="http://www.helpware.net/mshelp2/h2reg.htm" target="_blank">H2Reg.exe</a> from <a href="http://www.helpware.net" target="_blank">The Helpware Group</a>.  It is a command line tool that can be included by scripted installers as well as Windows
Installer packages as a custom action.</p><p>When producing an MS Help 2 file, the help file builder produces a valid set of collection files and
creates a configuration file suitable for use by <em>H2Reg.exe</em>.  In order to deploy the
generated HTML Help 2 files, follow these steps:</p><ol><li><p>Set the <span class="code">Plug In Namespaces</span> project property to a comma separated list of
one or more namespaces that your collection should be plugged into when deployed.  The default setting will plug
it into all available collections.  See the <em>H2Reg.exe</em> help file for details about the
possible values that can be used.</p></li><li><p>Build the help project.</p></li><li><p>Include all of the generated help files as well as the generated configuration file and the
<em>H2Reg.exe</em> executable in your installer.</p></li><li><p>During installation, copy the help files, the configuration file, and <em>H2Reg.exe</em>
to their installed location.</p></li><li><p>Execute <em>H2Reg.exe</em> with the following syntax:</p><div id="ID0EABDCAAABAA" class="codeSnippetContainer"><div class="codeSnippetContainerTabs" id="ID0EABDCAAABAA_tabs"></div><div id="ID0EABDCAAABAA_codecollection" class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EABDCAAABAA_copycode" href="#" onclick="javascript:CopyToClipboard('ID0EABDCAAABAA','4')" title="Copy to Clipboard">Copy to Clipboard</a><a id="ID0EABDCAAABAA_PrintText" class="OH_PrintText" href="#" onclick="javascript:Print('ID0EABDCAAABAA','4')" title="Print">Print</a></div></div><div id="ID0EABDCAAABAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre>H2Reg -r "CmdFile=&lt;Path to the configuration file&gt;"</pre></div><div id="ID0EABDCAAABAA_code_Plain_Div1" class="codeSnippetContainerCode" style="display: none"><pre>H2Reg -r "CmdFile=&lt;Path to the configuration file&gt;"</pre></div></div></div><script>addSpecificTextLanguageTagSet('ID0EABDCAAABAA');</script></li><li><p>During uninstallation, before the help files are removed, execute <em>H2Reg.exe</em>
with the following syntax:</p><div id="ID0EAADCAAABAA" class="codeSnippetContainer"><div class="codeSnippetContainerTabs" id="ID0EAADCAAABAA_tabs"></div><div id="ID0EAADCAAABAA_codecollection" class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAADCAAABAA_copycode" href="#" onclick="javascript:CopyToClipboard('ID0EAADCAAABAA','4')" title="Copy to Clipboard">Copy to Clipboard</a><a id="ID0EAADCAAABAA_PrintText" class="OH_PrintText" href="#" onclick="javascript:Print('ID0EAADCAAABAA','4')" title="Print">Print</a></div></div><div id="ID0EAADCAAABAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre>H2Reg -u "CmdFile=&lt;Path to the configuration file&gt;"</pre></div><div id="ID0EAADCAAABAA_code_Plain_Div1" class="codeSnippetContainerCode" style="display: none"><pre>H2Reg -u "CmdFile=&lt;Path to the configuration file&gt;"</pre></div></div></div><script>addSpecificTextLanguageTagSet('ID0EAADCAAABAA');</script></li></ol><p>Your product's installer can create a shortcut to open your Help 2 file by executing a command similar
to the following (lines wrapped for display purposes):</p><div id="ID0EBCAAABAA" class="codeSnippetContainer"><div class="codeSnippetContainerTabs" id="ID0EBCAAABAA_tabs"></div><div id="ID0EBCAAABAA_codecollection" class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EBCAAABAA_copycode" href="#" onclick="javascript:CopyToClipboard('ID0EBCAAABAA','4')" title="Copy to Clipboard">Copy to Clipboard</a><a id="ID0EBCAAABAA_PrintText" class="OH_PrintText" href="#" onclick="javascript:Print('ID0EBCAAABAA','4')" title="Print">Print</a></div></div><div id="ID0EBCAAABAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre>"%CommonProgramFiles%\Microsoft Shared\Help 9\dexplore.exe" /helpcol ms-help://MS.VSCC.v90
  /filter "[Your help title here]"</pre></div><div id="ID0EBCAAABAA_code_Plain_Div1" class="codeSnippetContainerCode" style="display: none"><pre>"%CommonProgramFiles%\Microsoft Shared\Help 9\dexplore.exe" /helpcol ms-help://MS.VSCC.v90
  /filter "[Your help title here]"</pre></div></div></div><script>addSpecificTextLanguageTagSet('ID0EBCAAABAA');</script><p>Substitute your product's help title project property value for "[Your help title here]" in the
example above.</p><a name="seeAlsoSection"></a><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">See Also</div></div><h4 class="subHeading">Other Resources</h4><div class="seeAlsoStyle"><a href="74664b00-b83f-450a-833a-25984ba812e3.htm">Named URL Index Support</a></div><div class="seeAlsoStyle"><a href="d0c2dabd-3caf-4586-b81d-cbd765dec7cf.htm">MS Help 2 Category Properties</a></div></div></div></div></div><div id="OH_footer" class="OH_footer"><p><a href="http://SHFB.CodePlex.com" target="_blank">[v2014.4.21.0] Copyright © 2006-2014, Eric Woodruff, All rights reserved</a></p><div class="OH_feedbacklink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:Eric%40EWoodruff.us?Subject=Sandcastle Help File Builder Documentation">Eric Woodruff</a></div><script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script></div><script src="//code.jquery.com/jquery-1.11.0.min.js"></script><script type="text/javascript">$(document).ready(function () {DocumentReady();});</script></body></html>